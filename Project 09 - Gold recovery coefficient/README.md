# Проект 09: Исследование технологического процесса очистки золота

### *Направление*: 
Машинное обучение, Data Analyst

### *Задача*: 
Спрогнозировать концентрацию золота при проведении процесса очистки золота

### *Описание*:
Строитстся модель машинного обучения для промышленной компании, разрабатывающая решения для эффективной работы промышленных предприятий. Модель должна предсказать коэффициент восстановления золота из золотосодержащей руды на основе данных с параметрами добычи и очистки. Модель поможет оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.

### *Инструменты*: 
Python, Pandas, Matplotlib, NumPy, Sklearn, исследовательский анализ данных

### *Вывод*:
В исходных данных мы видим следующее:
 - характеристики металлов на каждом этапе до и после прохождения определенного этапа
 - расчетные характеристики на первом этапе
 - характеристики отвальных хвостов после каждого этапа
 - характеристиках поданных реагентах
 - номер и характеристики флотационных установок
 - все три выборки содержат пропуски и нулевые/близкие к нулевым значения
 - дубликатов в выборках не обнаружено  

Мы определили целевые признаки: rougher.output.recovery и final.output.recovery.  
И проверили правильность расчета эфективности обогощения.  
Мы заполнили пропуски с помощью метода KNNimputer(). Пропущенное значение предсказано со ссылкой на среднее значение соседей.

Произведя графический анализ данных мы выяснили, что:
 - Основная цель процесса - восстановление золота, поэтому концентрация золота увеличивается, а серебра уменьшается.
 - Концентрация свинца увеличивается, скорее всего это связано с азотнокислого выщелачиванием, при котором образуется сульфат свинца.
 - Все графики показали аномалии в околонулевых значениях.
  
Визуально определили, что размеры гранул на обучающей и тестовой выборках совпадают. До флорации присутствуют выбросы в обоих выборках, значения на тестовой смещены относительно обучающей влево. Полагаю, данное смещение недостаточно, чтобы повлиять на оценку модели. После флотации смещение пропадает.
Обнаружили аномалию на графике суммарной концентрации веществ в околонулевой зоне на разных фазах процесса.
Мы написали функцию для определения точности модели с помощью sMAPE. И подготовили признаки для моделей.
Мы обучили 4 разные модели и записали результаты в таблицу model. У каждой модели мы выделили следующие характеристики:
 - name - название модели,
 - model_var - параметры модели, 
 - no_outliers - отсутствие аномалий в выборках,
 - smape_train, smape_test - ключевая характеристика для оценки точности модели.

Для теста на адекватность мы использовали 5-ую baseline-модель: Dummy Regressor. Все наши модели прошли тест на адекватность.
Лучший результат при обучении показала модель Случайного леса (sMAPE: 6.1495) с параметрами: max_depth: 5, n_estimators: 42.
Мы проверили эту модель на тестовой выборке, результат sMAPE: 9.986. Это лучше, чем у baseline-модели, но, на мой взгляд, точность должна быть выше.
